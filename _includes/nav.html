<header class="site-header" role="banner">
  <nav class="nav" role="navigation" aria-label="Main">
    <a class="nav__brand" href="{{ '/' | relative_url }}">{{ site.title }}</a>

    <button class="nav__toggle" type="button"
            aria-label="Open menu"
            aria-controls="primary-nav"
            aria-expanded="false">
      <span aria-hidden="true" class="nav__icon"></span>
    </button>

    <ul id="primary-nav" class="nav__links" hidden>
      <!-- Homepage sections (works from any page) -->
      <li><a href="{{ '/' | relative_url }}#offer">Offer</a></li>
      <li><a href="{{ '/' | relative_url }}#process">Process</a></li>
      <li><a href="{{ '/' | relative_url }}#pricing">Pricing</a></li>
      <li><a href="{{ '/' | relative_url }}#faq">FAQs</a></li>
      <li><a href="{{ '/' | relative_url }}#contact">Contact</a></li>

      <!-- Real pages -->
      <li><a href="{{ '/blog/' | relative_url }}">Blog</a></li>
      <li><a href="{{ '/self-discovery/' | relative_url }}">Self-Discovery</a></li>
    </ul>
  </nav>
</header>

<script>
  (function () {
    const header = document.currentScript.previousElementSibling; // <header>
    const btn = header.querySelector('.nav__toggle');
    const list = header.querySelector('#primary-nav');

    if (!btn || !list) return;

    function toggle(open) {
      btn.setAttribute('aria-expanded', String(open));
      btn.setAttribute('aria-label', open ? 'Close menu' : 'Open menu');
      if (open) list.removeAttribute('hidden');
      else list.setAttribute('hidden', '');
    }

    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const open = btn.getAttribute('aria-expanded') !== 'true';
      toggle(open);
    });

    // Close when a link is chosen (mobile UX)
    list.addEventListener('click', (e) => {
      if (e.target && e.target.tagName === 'A') toggle(false);
    });

    // Close on Escape
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') toggle(false);
    });

    // Close when clicking outside
    document.addEventListener('click', (e) => {
      const isOpen = btn.getAttribute('aria-expanded') === 'true';
      if (!isOpen) return;
      if (!header.contains(e.target)) toggle(false);
    });

    // If resizing up to desktop, ensure menu isn't stuck "hidden"
    window.addEventListener('resize', () => {
      if (window.matchMedia('(min-width: 861px)').matches) {
        toggle(false);
      }
    });
  })();
</script>